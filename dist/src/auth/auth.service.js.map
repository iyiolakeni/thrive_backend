{"version":3,"file":"auth.service.js","sourceRoot":"","sources":["../../../src/auth/auth.service.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,2CAA4C;AAC5C,qCAAyC;AACzC,uDAAoD;AACpD,iCAAgC;AAIzB,IAAM,WAAW,GAAjB,MAAM,WAAW;IACpB,YACY,YAAyB,EACzB,UAAsB;QADtB,iBAAY,GAAZ,YAAY,CAAa;QACzB,eAAU,GAAV,UAAU,CAAY;IAChC,CAAC;IAEH,KAAK,CAAC,YAAY,CAAC,KAAa,EAAE,QAAgB;QAC9C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC3D,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;QACjB,IAAI,IAAI,IAAI,MAAM,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAC,CAAC;YACvD,MAAM,EACF,QAAQ,EACR,GAAG,MAAM,EACZ,GAAG,IAAI,CAAC;YACT,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,OAAO,IAAI,CAAA;IACf,CAAC;IAED,KAAK,CAAC,KAAK,CAAC,IAAS;QACjB,MAAM,OAAO,GAAG;YACZ,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,EAAE;SAAC,CAAC;QACrC,OAAM;YACF,YAAY,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC;SAC9C,CAAC;IACN,CAAC;CACJ,CAAA;AA1BY,kCAAW;sBAAX,WAAW;IADvB,IAAA,mBAAU,GAAE;qCAGiB,0BAAW;QACb,gBAAU;GAHzB,WAAW,CA0BvB","sourcesContent":["import { Injectable } from '@nestjs/common';\r\nimport { JwtService } from '@nestjs/jwt';\r\nimport { UserService } from 'src/user/user.service';\r\nimport * as bcrypt from 'bcrypt'\r\nimport { User } from 'src/entities/user.entity/user.entity';\r\n\r\n@Injectable()\r\nexport class AuthService {\r\n    constructor (\r\n        private usersService: UserService,\r\n        private jwtService: JwtService,\r\n    ){}\r\n\r\n    async validateUser(email: string, password: string): Promise<any>{\r\n        const user = await this.usersService.findOneByEmail(email);\r\n        console.log(user)\r\n        if (user && await bcrypt.compare(password, user.password)){\r\n            const {\r\n                password,\r\n                ...result\r\n            } = user;\r\n            return result;\r\n        }\r\n        return null\r\n    }\r\n\r\n    async login(user: any){\r\n        const payload = {\r\n            email: user.email, sub: user.id};\r\n        return{\r\n            access_token: this.jwtService.sign(payload),\r\n        };\r\n    }\r\n}\r\n"]}