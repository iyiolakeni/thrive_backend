{"version":3,"file":"otp.service.js","sourceRoot":"","sources":["../../../src/auth/otp.service.ts"],"names":[],"mappings":";;;;;;;;;AACA,2CAA4C;AAC5C,8CAA8C;AAGvC,IAAM,UAAU,GAAhB,MAAM,UAAU;IAAhB;QACG,aAAQ,GAAwB,IAAI,GAAG,EAAE,CAAC;IAkBpD,CAAC;IAhBC,WAAW,CAAC,KAAa;QACvB,MAAM,GAAG,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,YAAY,EAAE,KAAK,EAAE,CAAC,CAAC;QAChH,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;QAE9B,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,CAAC;QACtD,OAAO,GAAG,CAAC;IACb,CAAC;IAED,SAAS,CAAC,KAAa,EAAE,GAAW;QAClC,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAC3C,IAAI,SAAS,KAAK,GAAG,EAAE,CAAC;YACtB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC5B,OAAO,IAAI,CAAC;QACd,CAAC;QACD,OAAO,KAAK,CAAC;IACf,CAAC;CACF,CAAA;AAnBY,gCAAU;qBAAV,UAAU;IADtB,IAAA,mBAAU,GAAE;GACA,UAAU,CAmBtB","sourcesContent":["// src/auth/otp.service.ts\r\nimport { Injectable } from '@nestjs/common';\r\nimport * as otpGenerator from 'otp-generator';\r\n\r\n@Injectable()\r\nexport class OtpService {\r\n  private otpStore: Map<string, string> = new Map();\r\n\r\n  generateOtp(phone: string): string {\r\n    const otp = otpGenerator.generate(6, { digits: true, alphabets: false, upperCase: false, specialChars: false });\r\n    this.otpStore.set(phone, otp);\r\n\r\n    setTimeout(() => this.otpStore.delete(phone), 300000);\r\n    return otp;\r\n  }\r\n\r\n  verifyOtp(phone: string, otp: string): boolean {\r\n    const storedOtp = this.otpStore.get(phone);\r\n    if (storedOtp === otp) {\r\n      this.otpStore.delete(phone);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n"]}